# CryptoProject1

## Encryption and Decryption Tool(Optinal)
encdec_tool.py
+ -e encryption 
+ -d decryption
+ -k key location <br/>
A key will be a permutation of 0 ~ 106, of which first 19 numbers are assigned to \<space\>,etc... An example of key will look like:
```
[26, 51, 25, 18, 101, 67, 48, 61, 0, 77, 31, 98, 75, 27, 78, 90, 13, 43, 97, 30, 71, 38, 46, 72, 68, 95, 91, 34, 16, 52, 104, 5, 56, 35, 69, 49, 47, 88, 17, 8, 86, 89, 100, 57, 54, 102, 96, 79, 66, 64, 62, 3, 80, 32, 7, 39, 10, 59, 45, 84, 1, 92, 70, 2, 14, 82, 21, 53, 28, 63, 33, 11, 93, 58, 6, 73, 83, 22, 55, 36, 23, 87, 60, 29, 85, 40, 74, 103, 99, 15, 65, 4, 105, 20, 19, 44, 42, 12, 37, 9, 50, 81, 94, 76, 41, 24]
```
A cipher file will look like
```
27,77,54,45,35,48,90,91,30,53,19,69,59,67,44,58,78,72,34,61,4,2,96,64,99,95,54,47,96,58,19,52,36,100,61,2,0,67,12,98,61,67,64,14,4,98,60,39,59,83,54,31,13,80,22,47,0,37,78,58,3,61,47,105,61,67,92,91,30,98,35,0,59,17,43,73,96,11,40,58,46,53,81,26,25,73,59,57,96,53,44,77,38,86,76,69,20,40,28,79,78,16,26,86,3,99,61,39,59,95,68,101,35,69,12,73,38,86,15,58,37,26,94,17,25,39,1,18,15,66,74,99,81,18,88,104,16,49,48,61,46,58,104,16,88,52,99,57,13,98,32,9,81,82,94,102,59,65,30,58,61,83,94,17,52,6,50,54,60,41,43,101,61,5,102,9,30,72,15,25,68,9,1,7,31,39,97,18,41,86,35,62,81,102,59,101,72,39,45,9,95,82,52,85,34,6,62,101,61,56,29,85,4,82,3,68,50,21,22,104,32,10,34,58,4,86,104,16,15,29,6,11,87,83,1,33,54,91,71,58,97,18,36,83,43,73,0,12,59,57,96,58,81,105,31,21,61,63,97,5,103,8,81,105,41,53,46,51,96,102,22,65,54,101,37,39,59,9,100,82,44,37,49,9,30,5,29,85,7,18,76,33,81,105,92,6,4,33,96,44,72,77,36,28,88,54,40,58,2,86,31,83,87,17,71,32,50,36,15,85,99,45,81,12,89,65,46,14,48,2,59,31,3,95,61,52,59,87,4,25,78,62,12,9,30,72,50,36,68,85,19,82,31,93,99,67,44,67,35,83,16,8,29,14,78,69,34,18,1,21,22,63,45,9,16,101,59,47,45,61,13,29,43,17,84,83,55,98,76,69,68,47,36,67,44,76,59,100,94,56,43,39,59,64,22,32,35,58,15,25,6,52,47,53,94,9,16,101,35,69,40,53,87,76,43,100,21,18,15,66,72,63,3,28,74,7,99,39,45,9,90,67,48,86,66,65,72,91,93,7,31,16,81,82,90,39,97,18,40,101,96,90,81,105,72,101,50,51,52,58,46,82,36,39,25,90,29,7,78,85,48,62,49,57,35,31,34,18,1,44,32,77,59,65,66,14,78,69,1,48,4,82,59,54,3,53,50,103,42,56,74,61,7,53,13,40,62,65,30,33,26,58,97,85,22,83,37,91,105,74,54,57,3,53,40,27,4,48,35,66,1,104,30,101,24,47,11,9,46,82,70,62,3,33,1,73,62,10,34,65,30,71,5,39,45,61,80,86,105,63,1,0,100,85,64,86,104,33,15,92,75,83,34,17,16,45,13,41,28,67,43,86,10,63,43,55,62,104,94,71,97,18,11,57,80,51,50,68,12,11,27,104,84,5,55,67,35,83,31,79,52,45,81,33,34,31,4,85,100,90,19,64,30,17,72,73,0,71,30,56,16,51,97,105,5,70,43,76,28,25,64,33,81,104,66,92,59,47,22,103,22,65,54,101,90,39,59,9,76,82,48,90,87,67,92,16,8,39,105,14,80,86,36,67,59,27,46,45,35,33,13,26,81,82,1,39,84,91,15,66,74,83,84,16,4,45,102,14,34,18,4,82,1,71,2,99,4,45,78,68,13,70,94,83,88,102,0,9,59,79,21,54,34,18,5,103,50,72,15,66,13,53,2,67,102,58,95,87,15,98,3,61,93,99,3,32,13,74,105,56,6,39,94,17,30,31,55,87,15,25,22,77,59,16,44,100,60,98,15,58,16,40,60,57,66,51,104,87,20,71,5,39,45,61,4,82,1,70,105,56,59,57,43,85,88,18,94,92,72,56,1,77,11,7,99,54,50,12,28,11,32,83,59,10,3,32,50,71,72,65,54,83,96,11,88,73,0,29,5,69,97,51,55,99,3,54,45,91,37,103,35,86,81,18,70,86,0,39,84,68,48,86,49,63,84,73,93,90,42,56,43,62,81,45,72,73,62,102,59,66,78,90,34,58,4,6,43,103,3,18,4,72,81,105,25,73,102,83,96,39,72,77,87,28,78,31,13,44,1,83,2,0,20,29,10,32,47,53,34,31,4,57,96,93,34,6,54,76,96,53,70,58,46,85,22,54,34,58,2,37,19,53,93,17,90,58,80,104,1,56,30,58,13,102,99,61,95,82,5,56,37,93,81,14,3,58,2,37,15,12,19,38,47,85,22,45,50,21,105,56,2,62,35,69,95,99,54,91,12,25,45,9,22,48,43,73,104,18,71,66,19,86,45,67,74,58,8,47,105,9,31,67,48,85,47,61,50,71,94,39,6,58,46,72,88,32,13,29,47,51,60,83,45,26,68,57,1,91,31,79,19,0,74,28,97,98,16,51,100,66,19,55,22,105,78,69,59,9,22,104,61,74,5,9,30,33,40,85,3,25,59,45,81,92,22,61,50,82,11,67,74,77,72,101,20,73,84,58,15,55,32,77,1,83,54,76,10,91,80,25,27,57,87,10,40,9,43,86,61,67,21,14,47,53,52,14,34,36,100,33,32,77,81,40,25,86,50,58,34,104,54,71,35,90,79,73,0,36,41,99,34,61,54,102,20,63,43,9,30,7,31,77,52,9,30,11,50,69,28,9,68,67,102,98,34,18,95,82,59,39,7,61,103,33,100,67,41,65,42,29,95,86,22,105,46,104,59,49,71,99,19,101,96,33,74,58,46,85,22,54,19,10,81,45,13,21,34,18,59,101,94,77,84,31,41,51,35,83,45,14,64,23,35,39,84,11,71,58,61,95,34,85,74,99,88,58,97,85,15,64,32,77,1,9,43,73,93,85,15,85,46,0,13,70,72,104,54,45,15,67,55,7,94,17,75,83,47,11,15,80,6,77,59,105,88,37,104,87,13,55,89,77,7,31,79,73,0,44,28,56,84,76,10,57,66,102,37,87,15,56,21,98,34,33,79,16,78,69,1,41,37,0,76,58,5,64,4,82,72,56,6,68,93,28,78,6,16,91,105,70,59,63,43,85,3,82,78,58,7,31,4,57,96,103,66,73,54,76,10,39,72,77,102,98,88,73,26,53,4,66,31,52,72,9,88,51,41,36,16,83,94,101,35,48,59,65,0,87,15,58,37,103,76,28,25,73,11,12,28,16,3,98,60,55,59,57,61,54,15,33,19,44,36,42,97,32,90,29,7,31,16,9,68,83,94,73,71,85,95,68,90,77,87,41,22,32,35,85,97,37,19,55,87,100,34,18,93,85,15,14,34,58,2,45,12,16,8,91,105,56,55,86,87,9,72,47,11,91,44,25,10,100,1,17,29,67,76,87,20,55,19,38,22,57,25,73,103,91,54,25,19,51,49,17,66,73,64,86,105,65,94,83,59,17,66,103,4,82,60,7,84,16,29,58,35,54,45,91,59,10,92,86,2,18,31,44,89,39,84,18,19,0,40,105,88,85,50,85,99,56,32,93,4,82,75,83,34,87,13,12,20,77,99,16,48,58,8,2,105,9,16,67,103,90,89,73,54,72,15,29,47,18,13,51,79,73,0,91,71,45,35,72,81,61,13,41,7,54,45,9,100,82,59,17,26,65,59,58,3,86,7,31,4,57,96,70,2,61,28,57,64,54,81,2,20,73,0,36,42,9,22,80,59,54,95,6,62,101,59,64,20,0,100,51,78,69,1,52,54,101,43,39,37,104,16,101,35,69,64,33,32,57,89,39,84,33,52,104,105,85,19,14,70,28,89,73,95,87,48,51,35,0,5,71,1,32,2,14,3,76,54,45,13,29,22,32,50,72,78,63,3,62,54,67,52,58,3,86,74,58,35,85,22,17,11,101,31,63,105,21,46,83,37,28,34,53,50,74,28,37,104,98,60,102,25,27,34,31,21,58,32,77,2,37,88,80,50,54,15,58,37,0,78,58,48,83,62,91,60,83,45,52,36,17,88,74,60,9,30,47,96,58,34,76,54,26,3,36,15,14,52,0,3,69,84,9,30,33,29,25,22,77,7,5,88,32,92,58,42,7,78,0,80,14,88,86,78,58,16,102,60,57,61,54,97,51,4,82,1,103,34,18,59,105,88,47,62,9,30,33,61,67,26,53,88,72,78,58,15,44,4,85,22,63,25,73,40,45,35,63,5,26,30,17,1,7,31,9,72,56,74,62,81,105,72,73,102,91,59,65,30,57,43,67,93,2,20,72,76,69,68,47,1,17,40,51,8,91,105,56,7,62,71,17,72,73,0,67,99,65,20,67,29,11,88,61,50,36,59,63,22,77,93,98,35,63,90,99,7,45,61,29,36,86,54,101,31,26,59,9,1,2,87,17,16,10,50,41,61,83,59,5,13,64,22,83,0,86,46,25,19,52,59,65,54,14,41,86,105,56,6,62,3,105,88,26,59,57,105,66,19,62,22,57,96,14,50,18,68,40,3,0,99,76,30,21,78,69,37,56,32,72,81,69,11,9,46,82,40,54,97,58,7,31,88,92,0,91,1,83,61,76,87,61,13,12,8,63,89,56,72,77,87,21,59,65,0,86,35,66,7,31,4,57,96,29,50,85,99,66,95,58,81,92,7,99,62,63,45,83,11,77,61,67,29,73,72,2,61,83,76,10,81,71,89,27,50,18,15,72,19,0,12,53,4,72,35,87,59,56,21,98,87,17,75,83,50,82,59,67,70,77,43,17,66,33,50,55,43,2,5,77,93,95,22,86,0,63,22,66,4,100,90,17,64,32,50,45,13,92,11,7,99,45,88,80,94,9,105,56,59,10,97,105,48,14,50,98,15,18,20,2,96,31,80,6,50,87,78,63,3,62,54,67,55,85,97,18,16,79,52,62,22,9,66,101,10,12,28,85,46,5,81,55,25,9,43,101,61,76,32,61,13,74,22,63,89,91,105,102,1,8,97,28,10,92,47,11,37,66,76,58,68,39,72,73,29,36,42,63,22,55,37,105,76,39,84,9,30,33,80,99,95,58,5,29,35,86,22,65,30,77,96,37,71,6,8,101,22,80,32,83,99,12,79,73,2,72,15,82,26,58,87,65,22,52,22,91,105,25,3,7,94,17,40,86,0,57,22,63,6,95,54,93,3,69,59,61,15,41,60,2,59,17,102,32,50,98,15,66,92,57,59,58,3,32,80,98,35,66,12,33,81,82,88,32,95,68,15,92,96,104,16,83,66,47,61,54,13,12,1,57,72,17,66,18,43,91,96,90,93,14,81,86,3,68,13,70,43,57,32,69,34,18,1,26,59,91,105,68,47,101,96,54,13,41,22,87,35,14,3,58,81,55,35,86,50,87,76,10,78,69,1,74,94,73,95,54,40,33,32,57,89,39,84,33,71,37,15,25,10,9,43,57,96,67,29,86,100,25,6,77,84,33,88,32,93,86,105,65,43,86,68,70,34,18,72,101,10,56,55,58,13,58,61,73,52,58,2,25,31,41,89,42,4,11,50,64,28,95,59,0,81,14,93,6,8,100,105,86,41,61,81,33,78,90,34,85,104,16,19,92,84,17,59,73,62,36,100,66,4,45,13,40,88,72,4,53,15,69,59,77,93,86,66,39,97,87,41,25,19,39,24,17,64,99,50,47,3,37,4,98,3,54,44,24,46,82,15,12,84,47,11,101,35,69,26,68,105,83,19,52,89,9,68,27,94,87,104,51,40,58,49,17,59,5,21,86,42,63,84,77,44,16,66,100,84,36,60,56,32,64,36,90,2,32,92,83,84,9,72,77,87,28,88,70,8,47,61,98,64,76,1,100,78,69,62,31,52,101,96,98,2,18,31,12,94,63,3,99,37,55,49,95,99,9,11,52,1,63,72,77,87,82,35,32,40,61,4,82,5,26,34,18,94,73,50,53,44,31,76,38,22,47,13,73,0,64,20,39,6,11,4,82,59,10,34,65,30,74,96,76,10,9,46,82,64,58,97,18,72,77,96,37,34,65,30,80,59,63,84,98,4,105,43,64,0,91,43,57,10,77,93,2,59,31,35,87,41,18,3,58,61,17,95,32,55,36,42,63,32,10,52,28,11,32,3,33,1,45,19,40,59,65,30,6,78,36,11,56,30,16,103,58,97,18,72,91,96,10,34,65,30,48,31,76,84,5,71,79,35,83,36,9,30,33,70,98,34,18,95,82,59,39,7,61,92,98,35,54,5,44,59,57,96,14,34,11,4,57,96,48,59,65,43,98,35,87,10,103,47,58,5,69,97,51,54,91,94,33,19,55,95,105,43,71,50,72,46,45,3,90,34,65,30,29,43,83,28,9,59,104,61,92,68,65,13,103,60,39,59,68,4,57,96,40,16,87,100,33,19,53,13,71,22,100,0,11,34,58,3,45,100,105,45,67,64,36,3,14,20,77,30,45,13,103,100,86,22,57,78,69,10,40,46,101,61,55,22,56,32,85,78,37,103,58,46,82,1,66,19,62,36,101,35,69,2,61,21,66,19,100,36,65,30,104,99,54,15,12,3,82,59,54,88,55,59,2,22,31,76,9,30,44,3,69,34,98,46,66,43,102,43,104,30,83,60,47,59,37,3,0,78,69,1,41,37,49,15,67,102,58,46,28,31,21,59,65,43,85,3,69,34,58,100,90,78,63,84,102,95,0,43,17,94,92,50,38,22,56,32,37,74,86,88,32,62,86,15,58,16,39,72,17,92,32,50,16,95,9,30,74,96,104,16,9,46,82,64,58,32,77,95,68,78,63,84,103,16,56,43,86,81,105,104,16,3,87,15,55,22,0,81,53,34,58,11,44,13,56,45,61,12,85,78,6,62,48,28,56,61,54,71,76,1,73,96,11,74,65,22,77,96,40,22,65,62,36,78,99,45,77,93,51,66,95,22,74,28,56,78,24,81,102,54,73,1,39,16,9,43,47,11,17,44,32,3,82,96,39,84,33,102,101,96,90,50,18,28,56,93,62,43,9,54,73,41,54,15,47,6,37,64,51,95,18,90,92,96,63,52,98,100,58,11,63,0,12,4,82,90,77,84,28,4,10,13,71,42,67,22,57,10,42,88,6,4,36,40,14,19,47,54,26,104,86,22,87,46,72,7,54,74,58,46,82,62,91,75,83,19,82,59,17,92,104,94,83,61,90,80,65,59,58,3,86,13,102,23,104,78,54,21,17,30,98,35,87,59,56,43,77,96,31,29,6,68,87,2,37,19,33,4,58,93,73,62,31,4,85,100,90,81,29,99,32,50,100,90,79,19,92,81,72,88,18,4,82,1,41,27,65,43,17,102,85,76,10,59,79,92,0,81,76,54,101,90,67,41,56,59,57,96,63,43,9,59,26,28,68,19,2,94,67,44,32,50,36,15,7,32,58,49,64,43,57,20,91,105,95,68,77,103,83,66,33,50,70,105,56,94,83,59,17,55,90,8,65,3,25,95,69,94,80,43,57,94,91,105,47,11,77,48,98,97,65,90,99,7,54,45,44,49,17,61,39,59,65,22,68,19,0,55,99,88,45,78,91,72,56,44,99,81,54,97,18,1,40,105,56,100,61,4,37,13,71,20,91,28,58,32,39,99,17,12,86,2,39,84,48,99,100,36,5,88,31,52,57,105,39,1,9,30,76,61,54,13,64,43,56,32,77,92,28,3,14,20,91,84,61,13,70,1,104,66,61,4,58,55,86,45,76,59,17,52,99,3,58,5,41,6,77,2,28,46,82,48,87,15,2,59,8,93,63,99,23,50,58,31,70,1,77,30,17,66,104,16,91,21,58,35,69,60,9,94,73,96,58,15,12,60,77,81,54,48,99,3,36,92,86,97,61,4,58,13,74,68,65,28,25,40,98,34,18,20,26,22,87,15,25,19,82,11,7,31,9,46,82,29,2,72,65,4,14,26,6,89,91,15,16,103,33,87,2,25,6,12,36,68,66,46,5,81,26,88,38,22,91,96,25,34,72,81,41,43,73,20,9,59,100,61,55,81,67,88,71,59,63,43,85,46,82,41,58,47,32,50,91,105,48,22,0,46,86,35,6,50,14,44,58,35,85,43,9,68,85,50,69,31,55,6,8,78,69,88,52,94,57,59,90,97,0,12,5,78,54,45,9,30,33,21,51,97,105,66,67,44,14,15,58,4,62,78,63,84,64,46,58,59,7,6,9,46,82,47,54,45,67,41,58,35,69,36,83,43,86,10,39,97,18,71,85,81,14,34,58,2,45,70,33,97,72,81,105,96,63,0,21,59,57,61,54,104,86,25,73,41,91,38,58,4,10,78,69,1,26,62,58,78,56,84,58,81,80,66,73,94,83,59,37,78,63,84,55,90,27,3,36,93,25,22,0,81,7,20,70,0,91,47,58,37,48,76,85,35,83,84,37,52,14,78,100,45,65,1,83,50,40,68,65,30,33,3,17,92,61,47,83,96,58,27,74,89,57,35,53,50,18,64,83,22,63,84,92,88,6,62,91,84,37,4,76,61,12,60,65,0,91,78,33,84,21,2,53,23,83,62,68,43,56,96,31,12,14,46,85,50,36,31,9,59,92,60,2,72,65,0,80,99,47,11,37,81,105,13,64,23,83,28,31,92,95,34,105,54,101,96,91,41,23,3,53,1,85,88,18,68,26,99,66,104,18,20,103,47,99,97,83,16
```
### Usage
The following command will generate a random key(you must use -k to specify where to output the key) and use it to encrypt plain.txt. The cipher will be auto stored to 'cipher.enc'.
```
python3 encdec_tool.py -e plain.txt -k a.key
```

The following command will decrypt the cipher by key. 
```
python3 encdec_tool.py -d cipher.enc -k a.key
```

## Crack
crack.py
+ -p \<plaintexts file\> : Known plaintexts. Each line in the plaintexts file will be treated as a plaintext.
```
python3 crack.py test1.enc -p known_plaintexts.txt 
```
+ -w \<Words file\> : Known words. Each line in the words file will be treated as a word. 
```
python3 crack.py test2.enc -w words.txt
```

+ number : You can set the limit of attempts to the program. The number can be insert anywhere.
```
python3 crack.py test2.enc 1000 -w words.txt
```

+ -a Auto mode : 
This mode will take in a plaintext instead of cipher. The program will generate a random key & encrypt itself and try to crack it, which is convenient for test.
```
python3 crack.py -a test1_plain.txt -p known_plaintexts.txt
```
If you don't provide a filename after '-a', you will need to manually input plaintext.
```
python3 crack.py -a -p known_plaintexts.txt
```

### Usage

Test1 (Known plaintexts): 
If you already have a cipher:
```
python3 crack.py test1.enc -p known_plaintexts.txt
```

Otherwise you can generate a cipher manually and crack it.
```
sed -n '3,3p' known_plaintexts.txt > plain.txt  # extract line 3 from known plaintexts.
python3 encdec_tool.py -e plain.txt -k a.key  # encrypt it, autosaved to cipher.enc
python3 crack.py cipher.enc -p known_plaintexts.txt
```

Test2 (Known word dictionaries):
```
python3 crack.py test2.enc -w words.txt
```
Test2 (Set maximum attempts to 1000)
```
python3 crack.py test2.enc 1000 -w words.txt
```

## Plain text generator(Optinal)

Also I provide a way to generate a random plain from the known words file.
```
python3 plain_creator.py words.txt -n 500 > test2_plain.txt  # randomly choose 500 words from words.txt
```
You can also use it to generate plaintext for known_plaintexts.txt.
```
python3 plain_creator.py words.txt 500 >> known_plaintexts.txt 
```
